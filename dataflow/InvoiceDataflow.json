{
	"name": "InvoiceDataflow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Landing_InvoiceDataset",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "DestinationDataset_hdo",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DestinationDataset_hdo",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Join1"
				},
				{
					"name": "AlterRow1"
				}
			],
			"script": "source(output(\n\t\tID as integer,\n\t\tFinanced as boolean,\n\t\tVoid as boolean,\n\t\tQualification as string,\n\t\tPriority as string,\n\t\tTax3Percentage as decimal(15,4),\n\t\tSvcRepairCode1 as string,\n\t\tSvcRepairCode2 as string,\n\t\tSvcRepairCode3 as string,\n\t\tSvcRepairCode4 as string,\n\t\tContractCode as string,\n\t\tSvcContract as string,\n\t\tUserFinished as string,\n\t\tUserPosted as string,\n\t\tUpdateHistoryWarranty as boolean,\n\t\tShipMethod as string,\n\t\tTimeCreated as string,\n\t\tTimeModified as string,\n\t\tTimeFinished as string,\n\t\tDispatchUnits as integer,\n\t\tEDIDateStamp as date,\n\t\tEDITimeStamp as string,\n\t\tPrintMethod as string,\n\t\tDispatchStartTime as string,\n\t\tTripChargeCode as string,\n\t\tTripChargeAmount as decimal(15,4),\n\t\tLocked as boolean,\n\t\tMobileTechInvoiceCode as string,\n\t\tServiceRequestID as string,\n\t\tCarrierCode as string,\n\t\tShipViaCode as string,\n\t\tJobStatusUpdate as boolean,\n\t\tDispatchEmail as boolean,\n\t\tLastDateSaved as date,\n\t\tLastTimeSaved as string,\n\t\tTerms as string,\n\t\tSvcEquipmentNumber as string,\n\t\tWebOrderID as string,\n\t\tDepartment as string,\n\t\tCreditStatusCode as string,\n\t\tCreditApprovedUserCode as string,\n\t\tCreditApprovedDateStamp as date,\n\t\tCreditApprovedTimeStamp as string,\n\t\tEDIMaroline as boolean,\n\t\tRequestedDate as date,\n\t\tSvcCSRInvoice as string,\n\t\tSvcSoldList as decimal(15,4),\n\t\tSvcSoldSTDCost as decimal(15,4),\n\t\tSvcFollowUpDate as date,\n\t\tSvcScheduleDate as date,\n\t\tTax2MaxAmount as decimal(15,4),\n\t\tEDIWhirlpool as boolean,\n\t\tMinDepositPercent as decimal(15,4),\n\t\tUnitModifier as integer,\n\t\tDateFinished as date,\n\t\tDatePosted as date,\n\t\tTimePosted as string,\n\t\tTTRTaxCalculated as boolean,\n\t\tPickUpBranchCode as string,\n\t\tPodiumOptOut as boolean,\n\t\tSignCustmizedFields as string,\n\t\tAVBSaleDateSent as date,\n\t\tAVBSaleTimeSent as string,\n\t\tsysCreated as timestamp,\n\t\tsysModified as timestamp,\n\t\tTTRJurisdictionCode as string,\n\t\tBranchCode as string,\n\t\tCOGSPosted as boolean,\n\t\tCallSequence as integer,\n\t\tCode as string,\n\t\tCommittedPaymentTotal as decimal(15,4),\n\t\tDateCreated as date,\n\t\tDateModified as date,\n\t\tDispatchPriority as string,\n\t\tDispatchRequestedRouteCode as string,\n\t\tDispatchSpecRequest as string,\n\t\tDispatchTime as string,\n\t\tDispatchTimeAM as string,\n\t\tEstimate as string,\n\t\tField1 as string,\n\t\tField2 as string,\n\t\tField3 as string,\n\t\tField4 as string,\n\t\tField5 as string,\n\t\tInvFinishDate as date,\n\t\tInvStartDate as date,\n\t\tInvTypeCode as string,\n\t\tItemListPriceCode as string,\n\t\tItemTotal as decimal(15,4),\n\t\tJobLocation as string,\n\t\tJobNumber as string,\n\t\tJobStatusCode as string,\n\t\tLaborRate as string,\n\t\tLaborTotal as decimal(15,4),\n\t\tMapReference as string,\n\t\tMapZoneCode as string,\n\t\tMiscTotal as decimal(15,4),\n\t\tOpenPaymentTotal as decimal(15,4),\n\t\tOtherListPriceCode as string,\n\t\tPONumber as string,\n\t\tPaymentTypeCode as string,\n\t\tPickUpDate as date,\n\t\tReference as string,\n\t\tSaleReferralCode as string,\n\t\tSalesperson1Code as string,\n\t\tSalesperson2Code as string,\n\t\tSalesperson2Percentage as decimal(15,4),\n\t\tScheduleDate as date,\n\t\tSerialListPriceCode as string,\n\t\tSerialTotal as decimal(15,4),\n\t\tStatus as string,\n\t\tSvcAgreementExpDate as date,\n\t\tSvcAgreementNumber as string,\n\t\tSvcBrandCode as string,\n\t\tSvcCenter as string,\n\t\tSvcCenterNumber as string,\n\t\tSvcComplaintCode as string,\n\t\tSvcComplaintDesc as string,\n\t\tSvcDatePurchased as date,\n\t\tSvcDealerCode as string,\n\t\tSvcDealerDesc as string,\n\t\tSvcDistributorNumber as string,\n\t\tSvcInWarranty as string,\n\t\tSvcMfgCodeEiaNumber as string,\n\t\tSvcMicroLeak as string,\n\t\tSvcMiles as decimal(15,4),\n\t\tSvcMilesRate as decimal(15,4),\n\t\tSvcMilesTotal as decimal(15,4),\n\t\tSvcModel as string,\n\t\tSvcMotorNewNumber as string,\n\t\tSvcMotorOldNumber as string,\n\t\tSvcPerformedCode as string,\n\t\tSvcPerformedDesc as string,\n\t\tSvcProduct as string,\n\t\tSvcProductCode as string,\n\t\tSvcRepairCatMinorMajor as string,\n\t\tSvcRepairCategory as string,\n\t\tSvcRepairCode as string,\n\t\tSvcRunNumber as string,\n\t\tSvcSerial as string,\n\t\tSvcSpecAuthNumber as string,\n\t\tSvcStockMerchandise as boolean,\n\t\tSvcTimeCompleted1 as string,\n\t\tSvcTimeCompleted2 as string,\n\t\tSvcTimeOnJob1 as string,\n\t\tSvcTimeOnJob2 as string,\n\t\tSvcTimeStarted1 as string,\n\t\tSvcTimeStarted2 as string,\n\t\tTax1Exempt as string,\n\t\tTax1Total as decimal(15,4),\n\t\tTax2Code as string,\n\t\tTax2Exempt as string,\n\t\tTax2Percentage as decimal(15,4),\n\t\tTax2Total as decimal(15,4),\n\t\tTax3Exempt as string,\n\t\tTax3Total as decimal(15,4),\n\t\tUserCreated as string,\n\t\tUserModified as string,\n\t\tWarranty as string,\n\t\tWarrantyField1 as string,\n\t\tWarrantyField2 as string,\n\t\tWarrantyField3 as string,\n\t\tWarrantyField4 as string,\n\t\tWarrantyField5 as string,\n\t\tWtyTotal as decimal(15,4)\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> source1\nsource(output(\n\t\tID as integer,\n\t\tFinanced as boolean,\n\t\tVoid as boolean,\n\t\tQualification as string,\n\t\tPriority as string,\n\t\tTax3Percentage as decimal(15,4),\n\t\tSvcRepairCode1 as string,\n\t\tSvcRepairCode2 as string,\n\t\tSvcRepairCode3 as string,\n\t\tSvcRepairCode4 as string,\n\t\tContractCode as string,\n\t\tSvcContract as string,\n\t\tUserFinished as string,\n\t\tUserPosted as string,\n\t\tUpdateHistoryWarranty as boolean,\n\t\tShipMethod as string,\n\t\tTimeCreated as string,\n\t\tTimeModified as string,\n\t\tTimeFinished as string,\n\t\tDispatchUnits as integer,\n\t\tEDIDateStamp as date,\n\t\tEDITimeStamp as string,\n\t\tPrintMethod as string,\n\t\tDispatchStartTime as string,\n\t\tTripChargeCode as string,\n\t\tTripChargeAmount as decimal(15,4),\n\t\tLocked as boolean,\n\t\tMobileTechInvoiceCode as string,\n\t\tServiceRequestID as string,\n\t\tCarrierCode as string,\n\t\tShipViaCode as string,\n\t\tJobStatusUpdate as boolean,\n\t\tDispatchEmail as boolean,\n\t\tLastDateSaved as date,\n\t\tLastTimeSaved as string,\n\t\tTerms as string,\n\t\tSvcEquipmentNumber as string,\n\t\tWebOrderID as string,\n\t\tDepartment as string,\n\t\tCreditStatusCode as string,\n\t\tCreditApprovedUserCode as string,\n\t\tCreditApprovedDateStamp as date,\n\t\tCreditApprovedTimeStamp as string,\n\t\tEDIMaroline as boolean,\n\t\tRequestedDate as date,\n\t\tSvcCSRInvoice as string,\n\t\tSvcSoldList as decimal(15,4),\n\t\tSvcSoldSTDCost as decimal(15,4),\n\t\tSvcFollowUpDate as date,\n\t\tSvcScheduleDate as date,\n\t\tTax2MaxAmount as decimal(15,4),\n\t\tEDIWhirlpool as boolean,\n\t\tMinDepositPercent as decimal(15,4),\n\t\tUnitModifier as integer,\n\t\tDateFinished as date,\n\t\tDatePosted as date,\n\t\tTimePosted as string,\n\t\tTTRTaxCalculated as boolean,\n\t\tPickUpBranchCode as string,\n\t\tPodiumOptOut as boolean,\n\t\tSignCustmizedFields as string,\n\t\tAVBSaleDateSent as date,\n\t\tAVBSaleTimeSent as string,\n\t\tsysCreated as timestamp,\n\t\tsysModified as timestamp,\n\t\tTTRJurisdictionCode as string,\n\t\tBranchCode as string,\n\t\tCOGSPosted as boolean,\n\t\tCallSequence as integer,\n\t\tCode as string,\n\t\tCommittedPaymentTotal as decimal(15,4),\n\t\tDateCreated as date,\n\t\tDateModified as date,\n\t\tDispatchPriority as string,\n\t\tDispatchRequestedRouteCode as string,\n\t\tDispatchSpecRequest as string,\n\t\tDispatchTime as string,\n\t\tDispatchTimeAM as string,\n\t\tEstimate as string,\n\t\tField1 as string,\n\t\tField2 as string,\n\t\tField3 as string,\n\t\tField4 as string,\n\t\tField5 as string,\n\t\tInvFinishDate as date,\n\t\tInvStartDate as date,\n\t\tInvTypeCode as string,\n\t\tItemListPriceCode as string,\n\t\tItemTotal as decimal(15,4),\n\t\tJobLocation as string,\n\t\tJobNumber as string,\n\t\tJobStatusCode as string,\n\t\tLaborRate as string,\n\t\tLaborTotal as decimal(15,4),\n\t\tMapReference as string,\n\t\tMapZoneCode as string,\n\t\tMiscTotal as decimal(15,4),\n\t\tOpenPaymentTotal as decimal(15,4),\n\t\tOtherListPriceCode as string,\n\t\tPONumber as string,\n\t\tPaymentTypeCode as string,\n\t\tPickUpDate as date,\n\t\tReference as string,\n\t\tSaleReferralCode as string,\n\t\tSalesperson1Code as string,\n\t\tSalesperson2Code as string,\n\t\tSalesperson2Percentage as decimal(15,4),\n\t\tScheduleDate as date,\n\t\tSerialListPriceCode as string,\n\t\tSerialTotal as decimal(15,4),\n\t\tStatus as string,\n\t\tSvcAgreementExpDate as date,\n\t\tSvcAgreementNumber as string,\n\t\tSvcBrandCode as string,\n\t\tSvcCenter as string,\n\t\tSvcCenterNumber as string,\n\t\tSvcComplaintCode as string,\n\t\tSvcComplaintDesc as string,\n\t\tSvcDatePurchased as date,\n\t\tSvcDealerCode as string,\n\t\tSvcDealerDesc as string,\n\t\tSvcDistributorNumber as string,\n\t\tSvcInWarranty as string,\n\t\tSvcMfgCodeEiaNumber as string,\n\t\tSvcMicroLeak as string,\n\t\tSvcMiles as decimal(15,4),\n\t\tSvcMilesRate as decimal(15,4),\n\t\tSvcMilesTotal as decimal(15,4),\n\t\tSvcModel as string,\n\t\tSvcMotorNewNumber as string,\n\t\tSvcMotorOldNumber as string,\n\t\tSvcPerformedCode as string,\n\t\tSvcPerformedDesc as string,\n\t\tSvcProduct as string,\n\t\tSvcProductCode as string,\n\t\tSvcRepairCatMinorMajor as string,\n\t\tSvcRepairCategory as string,\n\t\tSvcRepairCode as string,\n\t\tSvcRunNumber as string,\n\t\tSvcSerial as string,\n\t\tSvcSpecAuthNumber as string,\n\t\tSvcStockMerchandise as boolean,\n\t\tSvcTimeCompleted1 as string,\n\t\tSvcTimeCompleted2 as string,\n\t\tSvcTimeOnJob1 as string,\n\t\tSvcTimeOnJob2 as string,\n\t\tSvcTimeStarted1 as string,\n\t\tSvcTimeStarted2 as string,\n\t\tTax1Exempt as string,\n\t\tTax1Total as decimal(15,4),\n\t\tTax2Code as string,\n\t\tTax2Exempt as string,\n\t\tTax2Percentage as decimal(15,4),\n\t\tTax2Total as decimal(15,4),\n\t\tTax3Exempt as string,\n\t\tTax3Total as decimal(15,4),\n\t\tUserCreated as string,\n\t\tUserModified as string,\n\t\tWarranty as string,\n\t\tWarrantyField1 as string,\n\t\tWarrantyField2 as string,\n\t\tWarrantyField3 as string,\n\t\tWarrantyField4 as string,\n\t\tWarrantyField5 as string,\n\t\tWtyTotal as decimal(15,4)\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> source2\nsource1, source2 join(source1@Code == source2@Code,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nJoin1 alterRow(deleteIf(and(equals(source1@Code,source2@Code),source1@sysModified>source2@sysModified))) ~> AlterRow1\nAlterRow1 sink(allowSchemaDrift: false,\n\tvalidateSchema: false,\n\tinput(\n\t\tID as integer,\n\t\tFinanced as boolean,\n\t\tVoid as boolean,\n\t\tQualification as string,\n\t\tPriority as string,\n\t\tTax3Percentage as decimal(15,4),\n\t\tSvcRepairCode1 as string,\n\t\tSvcRepairCode2 as string,\n\t\tSvcRepairCode3 as string,\n\t\tSvcRepairCode4 as string,\n\t\tContractCode as string,\n\t\tSvcContract as string,\n\t\tUserFinished as string,\n\t\tUserPosted as string,\n\t\tUpdateHistoryWarranty as boolean,\n\t\tShipMethod as string,\n\t\tTimeCreated as string,\n\t\tTimeModified as string,\n\t\tTimeFinished as string,\n\t\tDispatchUnits as integer,\n\t\tEDIDateStamp as date,\n\t\tEDITimeStamp as string,\n\t\tPrintMethod as string,\n\t\tDispatchStartTime as string,\n\t\tTripChargeCode as string,\n\t\tTripChargeAmount as decimal(15,4),\n\t\tLocked as boolean,\n\t\tMobileTechInvoiceCode as string,\n\t\tServiceRequestID as string,\n\t\tCarrierCode as string,\n\t\tShipViaCode as string,\n\t\tJobStatusUpdate as boolean,\n\t\tDispatchEmail as boolean,\n\t\tLastDateSaved as date,\n\t\tLastTimeSaved as string,\n\t\tTerms as string,\n\t\tSvcEquipmentNumber as string,\n\t\tWebOrderID as string,\n\t\tDepartment as string,\n\t\tCreditStatusCode as string,\n\t\tCreditApprovedUserCode as string,\n\t\tCreditApprovedDateStamp as date,\n\t\tCreditApprovedTimeStamp as string,\n\t\tEDIMaroline as boolean,\n\t\tRequestedDate as date,\n\t\tSvcCSRInvoice as string,\n\t\tSvcSoldList as decimal(15,4),\n\t\tSvcSoldSTDCost as decimal(15,4),\n\t\tSvcFollowUpDate as date,\n\t\tSvcScheduleDate as date,\n\t\tTax2MaxAmount as decimal(15,4),\n\t\tEDIWhirlpool as boolean,\n\t\tMinDepositPercent as decimal(15,4),\n\t\tUnitModifier as integer,\n\t\tDateFinished as date,\n\t\tDatePosted as date,\n\t\tTimePosted as string,\n\t\tTTRTaxCalculated as boolean,\n\t\tPickUpBranchCode as string,\n\t\tPodiumOptOut as boolean,\n\t\tSignCustmizedFields as string,\n\t\tAVBSaleDateSent as date,\n\t\tAVBSaleTimeSent as string,\n\t\tsysCreated as timestamp,\n\t\tsysModified as timestamp,\n\t\tTTRJurisdictionCode as string,\n\t\tBranchCode as string,\n\t\tCOGSPosted as boolean,\n\t\tCallSequence as integer,\n\t\tCode as string,\n\t\tCommittedPaymentTotal as decimal(15,4),\n\t\tDateCreated as date,\n\t\tDateModified as date,\n\t\tDispatchPriority as string,\n\t\tDispatchRequestedRouteCode as string,\n\t\tDispatchSpecRequest as string,\n\t\tDispatchTime as string,\n\t\tDispatchTimeAM as string,\n\t\tEstimate as string,\n\t\tField1 as string,\n\t\tField2 as string,\n\t\tField3 as string,\n\t\tField4 as string,\n\t\tField5 as string,\n\t\tInvFinishDate as date,\n\t\tInvStartDate as date,\n\t\tInvTypeCode as string,\n\t\tItemListPriceCode as string,\n\t\tItemTotal as decimal(15,4),\n\t\tJobLocation as string,\n\t\tJobNumber as string,\n\t\tJobStatusCode as string,\n\t\tLaborRate as string,\n\t\tLaborTotal as decimal(15,4),\n\t\tMapReference as string,\n\t\tMapZoneCode as string,\n\t\tMiscTotal as decimal(15,4),\n\t\tOpenPaymentTotal as decimal(15,4),\n\t\tOtherListPriceCode as string,\n\t\tPONumber as string,\n\t\tPaymentTypeCode as string,\n\t\tPickUpDate as date,\n\t\tReference as string,\n\t\tSaleReferralCode as string,\n\t\tSalesperson1Code as string,\n\t\tSalesperson2Code as string,\n\t\tSalesperson2Percentage as decimal(15,4),\n\t\tScheduleDate as date,\n\t\tSerialListPriceCode as string,\n\t\tSerialTotal as decimal(15,4),\n\t\tStatus as string,\n\t\tSvcAgreementExpDate as date,\n\t\tSvcAgreementNumber as string,\n\t\tSvcBrandCode as string,\n\t\tSvcCenter as string,\n\t\tSvcCenterNumber as string,\n\t\tSvcComplaintCode as string,\n\t\tSvcComplaintDesc as string,\n\t\tSvcDatePurchased as date,\n\t\tSvcDealerCode as string,\n\t\tSvcDealerDesc as string,\n\t\tSvcDistributorNumber as string,\n\t\tSvcInWarranty as string,\n\t\tSvcMfgCodeEiaNumber as string,\n\t\tSvcMicroLeak as string,\n\t\tSvcMiles as decimal(15,4),\n\t\tSvcMilesRate as decimal(15,4),\n\t\tSvcMilesTotal as decimal(15,4),\n\t\tSvcModel as string,\n\t\tSvcMotorNewNumber as string,\n\t\tSvcMotorOldNumber as string,\n\t\tSvcPerformedCode as string,\n\t\tSvcPerformedDesc as string,\n\t\tSvcProduct as string,\n\t\tSvcProductCode as string,\n\t\tSvcRepairCatMinorMajor as string,\n\t\tSvcRepairCategory as string,\n\t\tSvcRepairCode as string,\n\t\tSvcRunNumber as string,\n\t\tSvcSerial as string,\n\t\tSvcSpecAuthNumber as string,\n\t\tSvcStockMerchandise as boolean,\n\t\tSvcTimeCompleted1 as string,\n\t\tSvcTimeCompleted2 as string,\n\t\tSvcTimeOnJob1 as string,\n\t\tSvcTimeOnJob2 as string,\n\t\tSvcTimeStarted1 as string,\n\t\tSvcTimeStarted2 as string,\n\t\tTax1Exempt as string,\n\t\tTax1Total as decimal(15,4),\n\t\tTax2Code as string,\n\t\tTax2Exempt as string,\n\t\tTax2Percentage as decimal(15,4),\n\t\tTax2Total as decimal(15,4),\n\t\tTax3Exempt as string,\n\t\tTax3Total as decimal(15,4),\n\t\tUserCreated as string,\n\t\tUserModified as string,\n\t\tWarranty as string,\n\t\tWarrantyField1 as string,\n\t\tWarrantyField2 as string,\n\t\tWarrantyField3 as string,\n\t\tWarrantyField4 as string,\n\t\tWarrantyField5 as string,\n\t\tWtyTotal as decimal(15,4)\n\t),\n\tdeletable:true,\n\tinsertable:true,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['Code'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}